/************************************************************************/

#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include "kin-dyn.h"
#include "drc_air.h"
#include "drc_lleg.h"
#include "drc_rleg.h"
#include "mex.h"

#define N_JOINTS 29
#define N_LINKS 29

#define LLEG_JOINTS 7
#define LLEG_LINKS 7

#define RLEG_JOINTS 7
#define RLEG_LINKS 7


void init_robot( KIN_DYN *r )
{

  r[0].joint_name = "groundj";
  r[0].link_name = "pelvis";
  r[0].index = 0;
  r[0].parent = -1;
  r[0].children[0] = 1;
  r[0].children[1] = 5;
  r[0].children[2] = 11;
  r[0].children[3] = -1;
  r[0].joint_offset_b[XX] = -0.0484;
  r[0].joint_offset_b[YY] = 0;
  r[0].joint_offset_b[ZZ] = 0.9271;
  r[0].joint_type = 9; // FREE
  r[0].axis_b[XX] = 1;
  r[0].axis_b[YY] = 0;
  r[0].axis_b[ZZ] = 0;
  r[0].mass = 14.2529;
  r[0].com_offset_b[XX] = 0.0111;
  r[0].com_offset_b[YY] = 0;
  r[0].com_offset_b[ZZ] = 0.0271;
  r[0].moi_diagonal = 0;
  r[0].moi_v[XX] = 0.1244;
  r[0].moi_v[YY] = 0.0958;
  r[0].moi_v[ZZ] = 0.1167;
  r[0].moi[XX][XX] = 0.1244;
  r[0].moi[XX][YY] = 0.0008;
  r[0].moi[XX][ZZ] = -0.0007;
  r[0].moi[YY][XX] = 0.0008;
  r[0].moi[YY][YY] = 0.0958;
  r[0].moi[YY][ZZ] = -0.0005;
  r[0].moi[ZZ][XX] = -0.0007;
  r[0].moi[ZZ][YY] = -0.0005;
  r[0].moi[ZZ][ZZ] = 0.1167;
  r[0].angle_limits[0] = 100.0; // NOT MEANINGFUL
  r[0].angle_limits[1] = 100.0;
  r[0].velocity_limits[0] = 100.0; // NOT MEANINGFUL
  r[0].velocity_limits[1] = 100.0;
  r[0].torque_limits[0] = 0; // NOT MEANINGFUL
  r[0].torque_limits[1] = 0;

  r[1].joint_name = "back_lbz";
  r[1].link_name = "ltorso";
  r[1].index = 1;
  r[1].parent = 0;
  r[1].children[0] = 2;
  r[1].children[1] = -1;
  r[1].joint_offset_b[XX] = -0.0125;
  r[1].joint_offset_b[YY] = 0;
  r[1].joint_offset_b[ZZ] = 0;
  r[1].joint_type = 4;
  r[1].axis_b[XX] = 0;
  r[1].axis_b[YY] = 0;
  r[1].axis_b[ZZ] = 1;
  r[1].mass = 1.92;
  r[1].com_offset_b[XX] = -0.0112984;
  r[1].com_offset_b[YY] = -3.15366e-06;
  r[1].com_offset_b[ZZ] = 0.0746835;
  r[1].moi_diagonal = 0;
  r[1].moi_v[XX] = 0.0039092;
  r[1].moi_v[YY] = 0.00341694;
  r[1].moi_v[ZZ] = 0.00174492;
  r[1].moi[XX][XX] = 0.0039092;
  r[1].moi[XX][YY] = -5.04491e-08;
  r[1].moi[XX][ZZ] = -0.000342157;
  r[1].moi[YY][XX] = -5.04491e-08;
  r[1].moi[YY][YY] = 0.00341694;
  r[1].moi[YY][ZZ] = 4.87119e-07;
  r[1].moi[ZZ][XX] = -0.000342157;
  r[1].moi[ZZ][YY] = 4.87119e-07;
  r[1].moi[ZZ][ZZ] = 0.00174492;
  r[1].angle_limits[0] = -0.610865;
  r[1].angle_limits[1] = 0.610865;
  r[1].velocity_limits[0] = -12;
  r[1].velocity_limits[1] = 12;
  r[1].torque_limits[0] = -124.016;
  r[1].torque_limits[1] = 124.016;

  r[2].joint_name = "back_mby";
  r[2].link_name = "mtorso";
  r[2].index = 2;
  r[2].parent = 1;
  r[2].children[0] = 3;
  r[2].children[1] = -1;
  r[2].joint_offset_b[XX] = 0;
  r[2].joint_offset_b[YY] = 0;
  r[2].joint_offset_b[ZZ] = 0.09;
  r[2].joint_type = 3;
  r[2].axis_b[XX] = 0;
  r[2].axis_b[YY] = 1;
  r[2].axis_b[ZZ] = 0;
  r[2].mass = 0.55;
  r[2].com_offset_b[XX] = -0.00816266;
  r[2].com_offset_b[YY] = -0.0131245;
  r[2].com_offset_b[ZZ] = 0.0305974;
  r[2].moi_diagonal = 0;
  r[2].moi_v[XX] = 0.000454181;
  r[2].moi_v[YY] = 0.000483282;
  r[2].moi_v[ZZ] = 0.000444215;
  r[2].moi[XX][XX] = 0.000454181;
  r[2].moi[XX][YY] = -6.10764e-05;
  r[2].moi[XX][ZZ] = 3.94009e-05;
  r[2].moi[YY][XX] = -6.10764e-05;
  r[2].moi[YY][YY] = 0.000483282;
  r[2].moi[YY][ZZ] = 5.27463e-05;
  r[2].moi[ZZ][XX] = 3.94009e-05;
  r[2].moi[ZZ][YY] = 5.27463e-05;
  r[2].moi[ZZ][ZZ] = 0.000444215;
  r[2].angle_limits[0] = -1.2;
  r[2].angle_limits[1] = 1.28;
  r[2].velocity_limits[0] = -12;
  r[2].velocity_limits[1] = 12;
  r[2].torque_limits[0] = -206.843;
  r[2].torque_limits[1] = 206.843;

  r[3].joint_name = "back_ubx";
  r[3].link_name = "utorso";
  r[3].index = 3;
  r[3].parent = 2;
  r[3].children[0] = 4;
  r[3].children[1] = 17;
  r[3].children[2] = 23;
  r[3].children[3] = -1;
  r[3].joint_offset_b[XX] = 0;
  r[3].joint_offset_b[YY] = 0;
  r[3].joint_offset_b[ZZ] = 0.05;
  r[3].joint_type = 2;
  r[3].axis_b[XX] = 1;
  r[3].axis_b[YY] = 0;
  r[3].axis_b[ZZ] = 0;
  r[3].mass = 18.484;
  r[3].com_offset_b[XX] = 0.02;
  r[3].com_offset_b[YY] = -0.001;
  r[3].com_offset_b[ZZ] = 0.211;
  r[3].moi_diagonal = 0;
  r[3].moi_v[XX] = 0.395;
  r[3].moi_v[YY] = 1.089;
  r[3].moi_v[ZZ] = 0.327;
  r[3].moi[XX][XX] = 0.395;
  r[3].moi[XX][YY] = 0;
  r[3].moi[XX][ZZ] = 0.083;
  r[3].moi[YY][XX] = 0;
  r[3].moi[YY][YY] = 1.089;
  r[3].moi[YY][ZZ] = -0.003;
  r[3].moi[ZZ][XX] = 0.083;
  r[3].moi[ZZ][YY] = -0.003;
  r[3].moi[ZZ][ZZ] = 0.327;
  r[3].angle_limits[0] = -0.790809;
  r[3].angle_limits[1] = 0.790809;
  r[3].velocity_limits[0] = -12;
  r[3].velocity_limits[1] = 12;
  r[3].torque_limits[0] = -94.91;
  r[3].torque_limits[1] = 94.91;

  r[4].joint_name = "neck_ay";
  r[4].link_name = "head";
  r[4].index = 4;
  r[4].parent = 3;
  r[4].children[0] = -1;
  r[4].joint_offset_b[XX] = 0.16555;
  r[4].joint_offset_b[YY] = 0;
  r[4].joint_offset_b[ZZ] = 0.50823;
  r[4].joint_type = 3;
  r[4].axis_b[XX] = 0;
  r[4].axis_b[YY] = 1;
  r[4].axis_b[ZZ] = 0;
  r[4].mass = 1.4199;
  r[4].com_offset_b[XX] = -0.075493;
  r[4].com_offset_b[YY] = 3.3383e-05;
  r[4].com_offset_b[ZZ] = 0.02774;
  r[4].moi_diagonal = 0;
  r[4].moi_v[XX] = 0.0039688;
  r[4].moi_v[YY] = 0.0041178;
  r[4].moi_v[ZZ] = 0.0035243;
  r[4].moi[XX][XX] = 0.0039688;
  r[4].moi[XX][YY] = -1.5797e-06;
  r[4].moi[XX][ZZ] = -0.00089293;
  r[4].moi[YY][XX] = -1.5797e-06;
  r[4].moi[YY][YY] = 0.0041178;
  r[4].moi[YY][ZZ] = -6.8415e-07;
  r[4].moi[ZZ][XX] = -0.00089293;
  r[4].moi[ZZ][YY] = -6.8415e-07;
  r[4].moi[ZZ][ZZ] = 0.0035243;
  r[4].angle_limits[0] = -0.610865;
  r[4].angle_limits[1] = 1.13446;
  r[4].velocity_limits[0] = -12;
  r[4].velocity_limits[1] = 12;
  r[4].torque_limits[0] = -5;
  r[4].torque_limits[1] = 5;

  r[5].joint_name = "l_leg_uhz";
  r[5].link_name = "l_uglut";
  r[5].index = 5;
  r[5].parent = 0;
  r[5].children[0] = 6;
  r[5].children[1] = -1;
  r[5].joint_offset_b[XX] = 0;
  r[5].joint_offset_b[YY] = 0.089;
  r[5].joint_offset_b[ZZ] = 0;
  r[5].joint_type = 4;
  r[5].axis_b[XX] = 0;
  r[5].axis_b[YY] = 0;
  r[5].axis_b[ZZ] = 1;
  r[5].mass = 0.5166;
  r[5].com_offset_b[XX] = 0.00529262;
  r[5].com_offset_b[YY] = -0.00344732;
  r[5].com_offset_b[ZZ] = 0.00313046;
  r[5].moi_diagonal = 0;
  r[5].moi_v[XX] = 0.00074276;
  r[5].moi_v[YY] = 0.000688179;
  r[5].moi_v[ZZ] = 0.00041242;
  r[5].moi[XX][XX] = 0.00074276;
  r[5].moi[XX][YY] = -3.79607e-08;
  r[5].moi[XX][ZZ] = -2.79549e-05;
  r[5].moi[YY][XX] = -3.79607e-08;
  r[5].moi[YY][YY] = 0.000688179;
  r[5].moi[YY][ZZ] = -3.2735e-08;
  r[5].moi[ZZ][XX] = -2.79549e-05;
  r[5].moi[ZZ][YY] = -3.2735e-08;
  r[5].moi[ZZ][ZZ] = 0.00041242;
  r[5].angle_limits[0] = -0.32;
  r[5].angle_limits[1] = 1.14;
  r[5].velocity_limits[0] = -12;
  r[5].velocity_limits[1] = 12;
  r[5].torque_limits[0] = -110;
  r[5].torque_limits[1] = 110;

  r[6].joint_name = "l_leg_mhx";
  r[6].link_name = "l_lglut";
  r[6].index = 6;
  r[6].parent = 5;
  r[6].children[0] = 7;
  r[6].children[1] = -1;
  r[6].joint_offset_b[XX] = 0;
  r[6].joint_offset_b[YY] = 0;
  r[6].joint_offset_b[ZZ] = 0;
  r[6].joint_type = 2;
  r[6].axis_b[XX] = 1;
  r[6].axis_b[YY] = 0;
  r[6].axis_b[ZZ] = 0;
  r[6].mass = 0.69;
  r[6].com_offset_b[XX] = 0.0133341;
  r[6].com_offset_b[YY] = 0.0170484;
  r[6].com_offset_b[ZZ] = -0.0312052;
  r[6].moi_diagonal = 0;
  r[6].moi_v[XX] = 0.000691326;
  r[6].moi_v[YY] = 0.00126856;
  r[6].moi_v[ZZ] = 0.00106487;
  r[6].moi[XX][XX] = 0.000691326;
  r[6].moi[XX][YY] = -2.24344e-05;
  r[6].moi[XX][ZZ] = 2.50508e-06;
  r[6].moi[YY][XX] = -2.24344e-05;
  r[6].moi[YY][YY] = 0.00126856;
  r[6].moi[YY][ZZ] = 0.000137862;
  r[6].moi[ZZ][XX] = 2.50508e-06;
  r[6].moi[ZZ][YY] = 0.000137862;
  r[6].moi[ZZ][ZZ] = 0.00106487;
  r[6].angle_limits[0] = -0.47;
  r[6].angle_limits[1] = 0.495;
  r[6].velocity_limits[0] = -12;
  r[6].velocity_limits[1] = 12;
  r[6].torque_limits[0] = -180;
  r[6].torque_limits[1] = 180;

  r[7].joint_name = "l_leg_lhy";
  r[7].link_name = "l_uleg";
  r[7].index = 7;
  r[7].parent = 6;
  r[7].children[0] = 8;
  r[7].children[1] = -1;
  r[7].joint_offset_b[XX] = 0.05;
  r[7].joint_offset_b[YY] = 0;
  r[7].joint_offset_b[ZZ] = -0.05;
  r[7].joint_type = 3;
  r[7].axis_b[XX] = 0;
  r[7].axis_b[YY] = 1;
  r[7].axis_b[ZZ] = 0;
  r[7].mass = 7.34;
  r[7].com_offset_b[XX] = 0;
  r[7].com_offset_b[YY] = 0;
  r[7].com_offset_b[ZZ] = -0.21;
  r[7].moi_diagonal = 1;
  r[7].moi_v[XX] = 0.09;
  r[7].moi_v[YY] = 0.09;
  r[7].moi_v[ZZ] = 0.02;
  r[7].moi[XX][XX] = 0.09;
  r[7].moi[XX][YY] = 0;
  r[7].moi[XX][ZZ] = 0;
  r[7].moi[YY][XX] = 0;
  r[7].moi[YY][YY] = 0.09;
  r[7].moi[YY][ZZ] = 0;
  r[7].moi[ZZ][XX] = 0;
  r[7].moi[ZZ][YY] = 0;
  r[7].moi[ZZ][ZZ] = 0.02;
  r[7].angle_limits[0] = -1.75;
  r[7].angle_limits[1] = 0.524;
  r[7].velocity_limits[0] = -12;
  r[7].velocity_limits[1] = 12;
  r[7].torque_limits[0] = -260;
  r[7].torque_limits[1] = 260;

  r[8].joint_name = "l_leg_kny";
  r[8].link_name = "l_lleg";
  r[8].index = 8;
  r[8].parent = 7;
  r[8].children[0] = 9;
  r[8].children[1] = -1;
  r[8].joint_offset_b[XX] = -0.05;
  r[8].joint_offset_b[YY] = 0;
  r[8].joint_offset_b[ZZ] = -0.374;
  r[8].joint_type = 3;
  r[8].axis_b[XX] = 0;
  r[8].axis_b[YY] = 1;
  r[8].axis_b[ZZ] = 0;
  r[8].mass = 4.367;
  r[8].com_offset_b[XX] = 0.001;
  r[8].com_offset_b[YY] = 0;
  r[8].com_offset_b[ZZ] = -0.187;
  r[8].moi_diagonal = 0;
  r[8].moi_v[XX] = 0.077;
  r[8].moi_v[YY] = 0.076;
  r[8].moi_v[ZZ] = 0.01;
  r[8].moi[XX][XX] = 0.077;
  r[8].moi[XX][YY] = 0;
  r[8].moi[XX][ZZ] = -0.003;
  r[8].moi[YY][XX] = 0;
  r[8].moi[YY][YY] = 0.076;
  r[8].moi[YY][ZZ] = 0;
  r[8].moi[ZZ][XX] = -0.003;
  r[8].moi[ZZ][YY] = 0;
  r[8].moi[ZZ][ZZ] = 0.01;
  r[8].angle_limits[0] = 0;
  r[8].angle_limits[1] = 2.45;
  r[8].velocity_limits[0] = -12;
  r[8].velocity_limits[1] = 12;
  r[8].torque_limits[0] = -220;
  r[8].torque_limits[1] = 220;

  r[9].joint_name = "l_leg_uay";
  r[9].link_name = "l_talus";
  r[9].index = 9;
  r[9].parent = 8;
  r[9].children[0] = 10;
  r[9].children[1] = -1;
  r[9].joint_offset_b[XX] = 0;
  r[9].joint_offset_b[YY] = 0;
  r[9].joint_offset_b[ZZ] = -0.422;
  r[9].joint_type = 3;
  r[9].axis_b[XX] = 0;
  r[9].axis_b[YY] = 1;
  r[9].axis_b[ZZ] = 0;
  r[9].mass = 0.1;
  r[9].com_offset_b[XX] = 0;
  r[9].com_offset_b[YY] = 0;
  r[9].com_offset_b[ZZ] = 0;
  r[9].moi_diagonal = 1;
  r[9].moi_v[XX] = 1.01674e-05;
  r[9].moi_v[YY] = 8.42775e-06;
  r[9].moi_v[ZZ] = 1.30101e-05;
  r[9].moi[XX][XX] = 1.01674e-05;
  r[9].moi[XX][YY] = 0;
  r[9].moi[XX][ZZ] = 0;
  r[9].moi[YY][XX] = 0;
  r[9].moi[YY][YY] = 8.42775e-06;
  r[9].moi[YY][ZZ] = 0;
  r[9].moi[ZZ][XX] = 0;
  r[9].moi[ZZ][YY] = 0;
  r[9].moi[ZZ][ZZ] = 1.30101e-05;
  r[9].angle_limits[0] = -0.698;
  r[9].angle_limits[1] = 0.698;
  r[9].velocity_limits[0] = -12;
  r[9].velocity_limits[1] = 12;
  r[9].torque_limits[0] = -220;
  r[9].torque_limits[1] = 220;

  r[10].joint_name = "l_leg_lax";
  r[10].link_name = "l_foot";
  r[10].index = 10;
  r[10].parent = 9;
  r[10].children[0] = -1;
  r[10].joint_offset_b[XX] = 0;
  r[10].joint_offset_b[YY] = 0;
  r[10].joint_offset_b[ZZ] = 0;
  r[10].joint_type = 2;
  r[10].axis_b[XX] = 1;
  r[10].axis_b[YY] = 0;
  r[10].axis_b[ZZ] = 0;
  r[10].mass = 1.634;
  r[10].com_offset_b[XX] = 0.027;
  r[10].com_offset_b[YY] = 0;
  r[10].com_offset_b[ZZ] = -0.067;
  r[10].moi_diagonal = 1;
  r[10].moi_v[XX] = 0.002;
  r[10].moi_v[YY] = 0.007;
  r[10].moi_v[ZZ] = 0.008;
  r[10].moi[XX][XX] = 0.002;
  r[10].moi[XX][YY] = 0;
  r[10].moi[XX][ZZ] = 0;
  r[10].moi[YY][XX] = 0;
  r[10].moi[YY][YY] = 0.007;
  r[10].moi[YY][ZZ] = 0;
  r[10].moi[ZZ][XX] = 0;
  r[10].moi[ZZ][YY] = 0;
  r[10].moi[ZZ][ZZ] = 0.008;
  r[10].angle_limits[0] = -0.436;
  r[10].angle_limits[1] = 0.436;
  r[10].velocity_limits[0] = -12;
  r[10].velocity_limits[1] = 12;
  r[10].torque_limits[0] = -90;
  r[10].torque_limits[1] = 90;

  r[11].joint_name = "r_leg_uhz";
  r[11].link_name = "r_uglut";
  r[11].index = 11;
  r[11].parent = 0;
  r[11].children[0] = 12;
  r[11].children[1] = -1;
  r[11].joint_offset_b[XX] = 0;
  r[11].joint_offset_b[YY] = -0.089;
  r[11].joint_offset_b[ZZ] = 0;
  r[11].joint_type = 4;
  r[11].axis_b[XX] = 0;
  r[11].axis_b[YY] = 0;
  r[11].axis_b[ZZ] = 1;
  r[11].mass = 0.5166;
  r[11].com_offset_b[XX] = 0.00529262;
  r[11].com_offset_b[YY] = 0.00344732;
  r[11].com_offset_b[ZZ] = 0.00313046;
  r[11].moi_diagonal = 0;
  r[11].moi_v[XX] = 0.00074276;
  r[11].moi_v[YY] = 0.000688179;
  r[11].moi_v[ZZ] = 0.00041242;
  r[11].moi[XX][XX] = 0.00074276;
  r[11].moi[XX][YY] = 3.79607e-08;
  r[11].moi[XX][ZZ] = -2.79549e-05;
  r[11].moi[YY][XX] = 3.79607e-08;
  r[11].moi[YY][YY] = 0.000688179;
  r[11].moi[YY][ZZ] = 3.2735e-08;
  r[11].moi[ZZ][XX] = -2.79549e-05;
  r[11].moi[ZZ][YY] = 3.2735e-08;
  r[11].moi[ZZ][ZZ] = 0.00041242;
  r[11].angle_limits[0] = -1.14;
  r[11].angle_limits[1] = 0.32;
  r[11].velocity_limits[0] = -12;
  r[11].velocity_limits[1] = 12;
  r[11].torque_limits[0] = -260;
  r[11].torque_limits[1] = 260;

  r[12].joint_name = "r_leg_mhx";
  r[12].link_name = "r_lglut";
  r[12].index = 12;
  r[12].parent = 11;
  r[12].children[0] = 13;
  r[12].children[1] = -1;
  r[12].joint_offset_b[XX] = 0;
  r[12].joint_offset_b[YY] = 0;
  r[12].joint_offset_b[ZZ] = 0;
  r[12].joint_type = 2;
  r[12].axis_b[XX] = 1;
  r[12].axis_b[YY] = 0;
  r[12].axis_b[ZZ] = 0;
  r[12].mass = 0.69;
  r[12].com_offset_b[XX] = 0.0133341;
  r[12].com_offset_b[YY] = -0.0170484;
  r[12].com_offset_b[ZZ] = -0.0312052;
  r[12].moi_diagonal = 0;
  r[12].moi_v[XX] = 0.000691326;
  r[12].moi_v[YY] = 0.00126856;
  r[12].moi_v[ZZ] = 0.00106487;
  r[12].moi[XX][XX] = 0.000691326;
  r[12].moi[XX][YY] = 2.24344e-05;
  r[12].moi[XX][ZZ] = 2.50508e-06;
  r[12].moi[YY][XX] = 2.24344e-05;
  r[12].moi[YY][YY] = 0.00126856;
  r[12].moi[YY][ZZ] = -0.000137862;
  r[12].moi[ZZ][XX] = 2.50508e-06;
  r[12].moi[ZZ][YY] = -0.000137862;
  r[12].moi[ZZ][ZZ] = 0.00106487;
  r[12].angle_limits[0] = -0.495;
  r[12].angle_limits[1] = 0.47;
  r[12].velocity_limits[0] = -12;
  r[12].velocity_limits[1] = 12;
  r[12].torque_limits[0] = -180;
  r[12].torque_limits[1] = 180;

  r[13].joint_name = "r_leg_lhy";
  r[13].link_name = "r_uleg";
  r[13].index = 13;
  r[13].parent = 12;
  r[13].children[0] = 14;
  r[13].children[1] = -1;
  r[13].joint_offset_b[XX] = 0.05;
  r[13].joint_offset_b[YY] = 0;
  r[13].joint_offset_b[ZZ] = -0.05;
  r[13].joint_type = 3;
  r[13].axis_b[XX] = 0;
  r[13].axis_b[YY] = 1;
  r[13].axis_b[ZZ] = 0;
  r[13].mass = 7.34;
  r[13].com_offset_b[XX] = 0;
  r[13].com_offset_b[YY] = 0;
  r[13].com_offset_b[ZZ] = -0.21;
  r[13].moi_diagonal = 1;
  r[13].moi_v[XX] = 0.09;
  r[13].moi_v[YY] = 0.09;
  r[13].moi_v[ZZ] = 0.02;
  r[13].moi[XX][XX] = 0.09;
  r[13].moi[XX][YY] = 0;
  r[13].moi[XX][ZZ] = 0;
  r[13].moi[YY][XX] = 0;
  r[13].moi[YY][YY] = 0.09;
  r[13].moi[YY][ZZ] = 0;
  r[13].moi[ZZ][XX] = 0;
  r[13].moi[ZZ][YY] = 0;
  r[13].moi[ZZ][ZZ] = 0.02;
  r[13].angle_limits[0] = -1.745;
  r[13].angle_limits[1] = 0.524;
  r[13].velocity_limits[0] = -12;
  r[13].velocity_limits[1] = 12;
  r[13].torque_limits[0] = -260;
  r[13].torque_limits[1] = 260;

  r[14].joint_name = "r_leg_kny";
  r[14].link_name = "r_lleg";
  r[14].index = 14;
  r[14].parent = 13;
  r[14].children[0] = 15;
  r[14].children[1] = -1;
  r[14].joint_offset_b[XX] = -0.05;
  r[14].joint_offset_b[YY] = 0;
  r[14].joint_offset_b[ZZ] = -0.374;
  r[14].joint_type = 3;
  r[14].axis_b[XX] = 0;
  r[14].axis_b[YY] = 1;
  r[14].axis_b[ZZ] = 0;
  r[14].mass = 4.367;
  r[14].com_offset_b[XX] = 0.001;
  r[14].com_offset_b[YY] = 0;
  r[14].com_offset_b[ZZ] = -0.187;
  r[14].moi_diagonal = 0;
  r[14].moi_v[XX] = 0.077;
  r[14].moi_v[YY] = 0.076;
  r[14].moi_v[ZZ] = 0.01;
  r[14].moi[XX][XX] = 0.077;
  r[14].moi[XX][YY] = -0;
  r[14].moi[XX][ZZ] = -0.003;
  r[14].moi[YY][XX] = -0;
  r[14].moi[YY][YY] = 0.076;
  r[14].moi[YY][ZZ] = -0;
  r[14].moi[ZZ][XX] = -0.003;
  r[14].moi[ZZ][YY] = -0;
  r[14].moi[ZZ][ZZ] = 0.01;
  r[14].angle_limits[0] = 0;
  r[14].angle_limits[1] = 2.45;
  r[14].velocity_limits[0] = -12;
  r[14].velocity_limits[1] = 12;
  r[14].torque_limits[0] = -220;
  r[14].torque_limits[1] = 220;

  r[15].joint_name = "r_leg_uay";
  r[15].link_name = "r_talus";
  r[15].index = 15;
  r[15].parent = 14;
  r[15].children[0] = 16;
  r[15].children[1] = -1;
  r[15].joint_offset_b[XX] = 0;
  r[15].joint_offset_b[YY] = 0;
  r[15].joint_offset_b[ZZ] = -0.422;
  r[15].joint_type = 3;
  r[15].axis_b[XX] = 0;
  r[15].axis_b[YY] = 1;
  r[15].axis_b[ZZ] = 0;
  r[15].mass = 0.1;
  r[15].com_offset_b[XX] = 0;
  r[15].com_offset_b[YY] = 0;
  r[15].com_offset_b[ZZ] = 0;
  r[15].moi_diagonal = 1;
  r[15].moi_v[XX] = 1.01674e-05;
  r[15].moi_v[YY] = 8.42775e-06;
  r[15].moi_v[ZZ] = 1.30101e-05;
  r[15].moi[XX][XX] = 1.01674e-05;
  r[15].moi[XX][YY] = 0;
  r[15].moi[XX][ZZ] = 0;
  r[15].moi[YY][XX] = 0;
  r[15].moi[YY][YY] = 8.42775e-06;
  r[15].moi[YY][ZZ] = 0;
  r[15].moi[ZZ][XX] = 0;
  r[15].moi[ZZ][YY] = 0;
  r[15].moi[ZZ][ZZ] = 1.30101e-05;
  r[15].angle_limits[0] = -0.698;
  r[15].angle_limits[1] = 0.698;
  r[15].velocity_limits[0] = -12;
  r[15].velocity_limits[1] = 12;
  r[15].torque_limits[0] = -220;
  r[15].torque_limits[1] = 220;

  r[16].joint_name = "r_leg_lax";
  r[16].link_name = "r_foot";
  r[16].index = 16;
  r[16].parent = 15;
  r[16].children[0] = -1;
  r[16].joint_offset_b[XX] = 0;
  r[16].joint_offset_b[YY] = 0;
  r[16].joint_offset_b[ZZ] = 0;
  r[16].joint_type = 2;
  r[16].axis_b[XX] = 1;
  r[16].axis_b[YY] = 0;
  r[16].axis_b[ZZ] = 0;
  r[16].mass = 1.634;
  r[16].com_offset_b[XX] = 0.027;
  r[16].com_offset_b[YY] = 0;
  r[16].com_offset_b[ZZ] = -0.067;
  r[16].moi_diagonal = 1;
  r[16].moi_v[XX] = 0.002;
  r[16].moi_v[YY] = 0.007;
  r[16].moi_v[ZZ] = 0.008;
  r[16].moi[XX][XX] = 0.002;
  r[16].moi[XX][YY] = 0;
  r[16].moi[XX][ZZ] = 0;
  r[16].moi[YY][XX] = 0;
  r[16].moi[YY][YY] = 0.007;
  r[16].moi[YY][ZZ] = 0;
  r[16].moi[ZZ][XX] = 0;
  r[16].moi[ZZ][YY] = 0;
  r[16].moi[ZZ][ZZ] = 0.008;
  r[16].angle_limits[0] = -0.436;
  r[16].angle_limits[1] = 0.436;
  r[16].velocity_limits[0] = -12;
  r[16].velocity_limits[1] = 12;
  r[16].torque_limits[0] = -90;
  r[16].torque_limits[1] = 90;

  r[17].joint_name = "l_arm_usy";
  r[17].link_name = "l_clav";
  r[17].index = 17;
  r[17].parent = 3;
  r[17].children[0] = 18;
  r[17].children[1] = -1;
  r[17].joint_offset_b[XX] = 0.024;
  r[17].joint_offset_b[YY] = 0.221;
  r[17].joint_offset_b[ZZ] = 0.289;
  r[17].joint_type = 1;
  r[17].axis_b[XX] = 0;
  r[17].axis_b[YY] = 0.5;
  r[17].axis_b[ZZ] = 0.866025;
  r[17].mass = 2.369;
  r[17].com_offset_b[XX] = 0.014;
  r[17].com_offset_b[YY] = 0.058;
  r[17].com_offset_b[ZZ] = 0.029;
  r[17].moi_diagonal = 0;
  r[17].moi_v[XX] = 0.004;
  r[17].moi_v[YY] = 0.006;
  r[17].moi_v[ZZ] = 0.007;
  r[17].moi[XX][XX] = 0.004;
  r[17].moi[XX][YY] = 0.001;
  r[17].moi[XX][ZZ] = 0;
  r[17].moi[YY][XX] = 0.001;
  r[17].moi[YY][YY] = 0.006;
  r[17].moi[YY][ZZ] = 0;
  r[17].moi[ZZ][XX] = 0;
  r[17].moi[ZZ][YY] = 0;
  r[17].moi[ZZ][ZZ] = 0.007;
  r[17].angle_limits[0] = -1.9635;
  r[17].angle_limits[1] = 1.9635;
  r[17].velocity_limits[0] = -12;
  r[17].velocity_limits[1] = 12;
  r[17].torque_limits[0] = -212;
  r[17].torque_limits[1] = 212;

  r[18].joint_name = "l_arm_shx";
  r[18].link_name = "l_scap";
  r[18].index = 18;
  r[18].parent = 17;
  r[18].children[0] = 19;
  r[18].children[1] = -1;
  r[18].joint_offset_b[XX] = 0;
  r[18].joint_offset_b[YY] = 0.075;
  r[18].joint_offset_b[ZZ] = 0.036;
  r[18].joint_type = 2;
  r[18].axis_b[XX] = 1;
  r[18].axis_b[YY] = 0;
  r[18].axis_b[ZZ] = 0;
  r[18].mass = 2.707;
  r[18].com_offset_b[XX] = -0.002;
  r[18].com_offset_b[YY] = 0.108;
  r[18].com_offset_b[ZZ] = 0;
  r[18].moi_diagonal = 1;
  r[18].moi_v[XX] = 0.01;
  r[18].moi_v[YY] = 0.005;
  r[18].moi_v[ZZ] = 0.013;
  r[18].moi[XX][XX] = 0.01;
  r[18].moi[XX][YY] = 0;
  r[18].moi[XX][ZZ] = 0;
  r[18].moi[YY][XX] = 0;
  r[18].moi[YY][YY] = 0.005;
  r[18].moi[YY][ZZ] = 0;
  r[18].moi[ZZ][XX] = 0;
  r[18].moi[ZZ][YY] = 0;
  r[18].moi[ZZ][ZZ] = 0.013;
  r[18].angle_limits[0] = -1.39626;
  r[18].angle_limits[1] = 1.74533;
  r[18].velocity_limits[0] = -12;
  r[18].velocity_limits[1] = 12;
  r[18].torque_limits[0] = -170;
  r[18].torque_limits[1] = 170;

  r[19].joint_name = "l_arm_ely";
  r[19].link_name = "l_uarm";
  r[19].index = 19;
  r[19].parent = 18;
  r[19].children[0] = 20;
  r[19].children[1] = -1;
  r[19].joint_offset_b[XX] = 0;
  r[19].joint_offset_b[YY] = 0.185;
  r[19].joint_offset_b[ZZ] = 0;
  r[19].joint_type = 3;
  r[19].axis_b[XX] = 0;
  r[19].axis_b[YY] = 1;
  r[19].axis_b[ZZ] = 0;
  r[19].mass = 1.881;
  r[19].com_offset_b[XX] = 0.007;
  r[19].com_offset_b[YY] = 0.114;
  r[19].com_offset_b[ZZ] = 0.008;
  r[19].moi_diagonal = 1;
  r[19].moi_v[XX] = 0.002;
  r[19].moi_v[YY] = 0.003;
  r[19].moi_v[ZZ] = 0.003;
  r[19].moi[XX][XX] = 0.002;
  r[19].moi[XX][YY] = 0;
  r[19].moi[XX][ZZ] = 0;
  r[19].moi[YY][XX] = 0;
  r[19].moi[YY][YY] = 0.003;
  r[19].moi[YY][ZZ] = 0;
  r[19].moi[ZZ][XX] = 0;
  r[19].moi[ZZ][YY] = 0;
  r[19].moi[ZZ][ZZ] = 0.003;
  r[19].angle_limits[0] = 0;
  r[19].angle_limits[1] = 3.14159;
  r[19].velocity_limits[0] = -12;
  r[19].velocity_limits[1] = 12;
  r[19].torque_limits[0] = -114;
  r[19].torque_limits[1] = 114;

  r[20].joint_name = "l_arm_elx";
  r[20].link_name = "l_larm";
  r[20].index = 20;
  r[20].parent = 19;
  r[20].children[0] = 21;
  r[20].children[1] = -1;
  r[20].joint_offset_b[XX] = 0;
  r[20].joint_offset_b[YY] = 0.121;
  r[20].joint_offset_b[ZZ] = 0.013;
  r[20].joint_type = 2;
  r[20].axis_b[XX] = 1;
  r[20].axis_b[YY] = 0;
  r[20].axis_b[ZZ] = 0;
  r[20].mass = 2.148;
  r[20].com_offset_b[XX] = -0.003;
  r[20].com_offset_b[YY] = 0.099;
  r[20].com_offset_b[ZZ] = -0.014;
  r[20].moi_diagonal = 1;
  r[20].moi_v[XX] = 0.005;
  r[20].moi_v[YY] = 0.003;
  r[20].moi_v[ZZ] = 0.006;
  r[20].moi[XX][XX] = 0.005;
  r[20].moi[XX][YY] = 0;
  r[20].moi[XX][ZZ] = 0;
  r[20].moi[YY][XX] = 0;
  r[20].moi[YY][YY] = 0.003;
  r[20].moi[YY][ZZ] = 0;
  r[20].moi[ZZ][XX] = 0;
  r[20].moi[ZZ][YY] = 0;
  r[20].moi[ZZ][ZZ] = 0.006;
  r[20].angle_limits[0] = 0;
  r[20].angle_limits[1] = 2.35619;
  r[20].velocity_limits[0] = -12;
  r[20].velocity_limits[1] = 12;
  r[20].torque_limits[0] = -114;
  r[20].torque_limits[1] = 114;

  r[21].joint_name = "l_arm_uwy";
  r[21].link_name = "l_farm";
  r[21].index = 21;
  r[21].parent = 20;
  r[21].children[0] = 22;
  r[21].children[1] = -1;
  r[21].joint_offset_b[XX] = 0;
  r[21].joint_offset_b[YY] = 0.188;
  r[21].joint_offset_b[ZZ] = -0.013;
  r[21].joint_type = 3;
  r[21].axis_b[XX] = 0;
  r[21].axis_b[YY] = 1;
  r[21].axis_b[ZZ] = 0;
  r[21].mass = 0.981;
  r[21].com_offset_b[XX] = 0;
  r[21].com_offset_b[YY] = 0.041;
  r[21].com_offset_b[ZZ] = 0;
  r[21].moi_diagonal = 1;
  r[21].moi_v[XX] = 0.003;
  r[21].moi_v[YY] = 0.001;
  r[21].moi_v[ZZ] = 0.003;
  r[21].moi[XX][XX] = 0.003;
  r[21].moi[XX][YY] = 0;
  r[21].moi[XX][ZZ] = 0;
  r[21].moi[YY][XX] = 0;
  r[21].moi[YY][YY] = 0.001;
  r[21].moi[YY][ZZ] = 0;
  r[21].moi[ZZ][XX] = 0;
  r[21].moi[ZZ][YY] = 0;
  r[21].moi[ZZ][ZZ] = 0.003;
  r[21].angle_limits[0] = -1.571;
  r[21].angle_limits[1] = 1.571;
  r[21].velocity_limits[0] = -12;
  r[21].velocity_limits[1] = 12;
  r[21].torque_limits[0] = -114;
  r[21].torque_limits[1] = 114;

  r[22].joint_name = "l_arm_mwx";
  r[22].link_name = "l_hand";
  r[22].index = 22;
  r[22].parent = 21;
  r[22].children[0] = -1;
  r[22].joint_offset_b[XX] = 0;
  r[22].joint_offset_b[YY] = 0.058;
  r[22].joint_offset_b[ZZ] = 0;
  r[22].joint_type = 2;
  r[22].axis_b[XX] = 1;
  r[22].axis_b[YY] = 0;
  r[22].axis_b[ZZ] = 0;
  r[22].mass = 2.263;
  r[22].com_offset_b[XX] = 0;
  r[22].com_offset_b[YY] = 0.093;
  r[22].com_offset_b[ZZ] = 0;
  r[22].moi_diagonal = 1;
  r[22].moi_v[XX] = 0.01;
  r[22].moi_v[YY] = 0.002;
  r[22].moi_v[ZZ] = 0.01;
  r[22].moi[XX][XX] = 0.01;
  r[22].moi[XX][YY] = 0;
  r[22].moi[XX][ZZ] = 0;
  r[22].moi[YY][XX] = 0;
  r[22].moi[YY][YY] = 0.002;
  r[22].moi[YY][ZZ] = 0;
  r[22].moi[ZZ][XX] = 0;
  r[22].moi[ZZ][YY] = 0;
  r[22].moi[ZZ][ZZ] = 0.01;
  r[22].angle_limits[0] = -0.436;
  r[22].angle_limits[1] = 1.571;
  r[22].velocity_limits[0] = -12;
  r[22].velocity_limits[1] = 12;
  r[22].torque_limits[0] = -60;
  r[22].torque_limits[1] = 60;

  r[23].joint_name = "r_arm_usy";
  r[23].link_name = "r_clav";
  r[23].index = 23;
  r[23].parent = 3;
  r[23].children[0] = 24;
  r[23].children[1] = -1;
  r[23].joint_offset_b[XX] = 0.024;
  r[23].joint_offset_b[YY] = -0.221;
  r[23].joint_offset_b[ZZ] = 0.289;
  r[23].joint_type = 1;
  r[23].axis_b[XX] = 0;
  r[23].axis_b[YY] = 0.5;
  r[23].axis_b[ZZ] = -0.866025;
  r[23].mass = 2.369;
  r[23].com_offset_b[XX] = 0.014;
  r[23].com_offset_b[YY] = -0.058;
  r[23].com_offset_b[ZZ] = 0.029;
  r[23].moi_diagonal = 0;
  r[23].moi_v[XX] = 0.004;
  r[23].moi_v[YY] = 0.006;
  r[23].moi_v[ZZ] = 0.007;
  r[23].moi[XX][XX] = 0.004;
  r[23].moi[XX][YY] = -0.001;
  r[23].moi[XX][ZZ] = 0;
  r[23].moi[YY][XX] = -0.001;
  r[23].moi[YY][YY] = 0.006;
  r[23].moi[YY][ZZ] = 0;
  r[23].moi[ZZ][XX] = 0;
  r[23].moi[ZZ][YY] = 0;
  r[23].moi[ZZ][ZZ] = 0.007;
  r[23].angle_limits[0] = -1.9635;
  r[23].angle_limits[1] = 1.9635;
  r[23].velocity_limits[0] = -12;
  r[23].velocity_limits[1] = 12;
  r[23].torque_limits[0] = -212;
  r[23].torque_limits[1] = 212;

  r[24].joint_name = "r_arm_shx";
  r[24].link_name = "r_scap";
  r[24].index = 24;
  r[24].parent = 23;
  r[24].children[0] = 25;
  r[24].children[1] = -1;
  r[24].joint_offset_b[XX] = 0;
  r[24].joint_offset_b[YY] = -0.075;
  r[24].joint_offset_b[ZZ] = 0.036;
  r[24].joint_type = 2;
  r[24].axis_b[XX] = 1;
  r[24].axis_b[YY] = 0;
  r[24].axis_b[ZZ] = 0;
  r[24].mass = 2.707;
  r[24].com_offset_b[XX] = -0.002;
  r[24].com_offset_b[YY] = -0.108;
  r[24].com_offset_b[ZZ] = 0;
  r[24].moi_diagonal = 1;
  r[24].moi_v[XX] = 0.01;
  r[24].moi_v[YY] = 0.005;
  r[24].moi_v[ZZ] = 0.013;
  r[24].moi[XX][XX] = 0.01;
  r[24].moi[XX][YY] = 0;
  r[24].moi[XX][ZZ] = 0;
  r[24].moi[YY][XX] = 0;
  r[24].moi[YY][YY] = 0.005;
  r[24].moi[YY][ZZ] = 0;
  r[24].moi[ZZ][XX] = 0;
  r[24].moi[ZZ][YY] = 0;
  r[24].moi[ZZ][ZZ] = 0.013;
  r[24].angle_limits[0] = -1.74533;
  r[24].angle_limits[1] = 1.39626;
  r[24].velocity_limits[0] = -12;
  r[24].velocity_limits[1] = 12;
  r[24].torque_limits[0] = -170;
  r[24].torque_limits[1] = 170;

  r[25].joint_name = "r_arm_ely";
  r[25].link_name = "r_uarm";
  r[25].index = 25;
  r[25].parent = 24;
  r[25].children[0] = 26;
  r[25].children[1] = -1;
  r[25].joint_offset_b[XX] = 0;
  r[25].joint_offset_b[YY] = -0.185;
  r[25].joint_offset_b[ZZ] = 0;
  r[25].joint_type = 3;
  r[25].axis_b[XX] = 0;
  r[25].axis_b[YY] = 1;
  r[25].axis_b[ZZ] = 0;
  r[25].mass = 1.881;
  r[25].com_offset_b[XX] = 0.007;
  r[25].com_offset_b[YY] = -0.114;
  r[25].com_offset_b[ZZ] = 0.008;
  r[25].moi_diagonal = 1;
  r[25].moi_v[XX] = 0.002;
  r[25].moi_v[YY] = 0.003;
  r[25].moi_v[ZZ] = 0.003;
  r[25].moi[XX][XX] = 0.002;
  r[25].moi[XX][YY] = 0;
  r[25].moi[XX][ZZ] = 0;
  r[25].moi[YY][XX] = 0;
  r[25].moi[YY][YY] = 0.003;
  r[25].moi[YY][ZZ] = 0;
  r[25].moi[ZZ][XX] = 0;
  r[25].moi[ZZ][YY] = 0;
  r[25].moi[ZZ][ZZ] = 0.003;
  r[25].angle_limits[0] = 0;
  r[25].angle_limits[1] = 3.14159;
  r[25].velocity_limits[0] = -12;
  r[25].velocity_limits[1] = 12;
  r[25].torque_limits[0] = -114;
  r[25].torque_limits[1] = 114;

  r[26].joint_name = "r_arm_elx";
  r[26].link_name = "r_larm";
  r[26].index = 26;
  r[26].parent = 25;
  r[26].children[0] = 27;
  r[26].children[1] = -1;
  r[26].joint_offset_b[XX] = 0;
  r[26].joint_offset_b[YY] = -0.121;
  r[26].joint_offset_b[ZZ] = 0.013;
  r[26].joint_type = 2;
  r[26].axis_b[XX] = 1;
  r[26].axis_b[YY] = 0;
  r[26].axis_b[ZZ] = 0;
  r[26].mass = 2.148;
  r[26].com_offset_b[XX] = -0.003;
  r[26].com_offset_b[YY] = -0.099;
  r[26].com_offset_b[ZZ] = -0.014;
  r[26].moi_diagonal = 1;
  r[26].moi_v[XX] = 0.005;
  r[26].moi_v[YY] = 0.003;
  r[26].moi_v[ZZ] = 0.006;
  r[26].moi[XX][XX] = 0.005;
  r[26].moi[XX][YY] = 0;
  r[26].moi[XX][ZZ] = 0;
  r[26].moi[YY][XX] = 0;
  r[26].moi[YY][YY] = 0.003;
  r[26].moi[YY][ZZ] = 0;
  r[26].moi[ZZ][XX] = 0;
  r[26].moi[ZZ][YY] = 0;
  r[26].moi[ZZ][ZZ] = 0.006;
  r[26].angle_limits[0] = -2.35619;
  r[26].angle_limits[1] = 0;
  r[26].velocity_limits[0] = -12;
  r[26].velocity_limits[1] = 12;
  r[26].torque_limits[0] = -114;
  r[26].torque_limits[1] = 114;

  r[27].joint_name = "r_arm_uwy";
  r[27].link_name = "r_farm";
  r[27].index = 27;
  r[27].parent = 26;
  r[27].children[0] = 28;
  r[27].children[1] = -1;
  r[27].joint_offset_b[XX] = 0;
  r[27].joint_offset_b[YY] = -0.188;
  r[27].joint_offset_b[ZZ] = -0.013;
  r[27].joint_type = 3;
  r[27].axis_b[XX] = 0;
  r[27].axis_b[YY] = 1;
  r[27].axis_b[ZZ] = 0;
  r[27].mass = 0.981;
  r[27].com_offset_b[XX] = 0;
  r[27].com_offset_b[YY] = -0.041;
  r[27].com_offset_b[ZZ] = 0;
  r[27].moi_diagonal = 1;
  r[27].moi_v[XX] = 0.003;
  r[27].moi_v[YY] = 0.001;
  r[27].moi_v[ZZ] = 0.003;
  r[27].moi[XX][XX] = 0.003;
  r[27].moi[XX][YY] = 0;
  r[27].moi[XX][ZZ] = 0;
  r[27].moi[YY][XX] = 0;
  r[27].moi[YY][YY] = 0.001;
  r[27].moi[YY][ZZ] = 0;
  r[27].moi[ZZ][XX] = 0;
  r[27].moi[ZZ][YY] = 0;
  r[27].moi[ZZ][ZZ] = 0.003;
  r[27].angle_limits[0] = -1.571;
  r[27].angle_limits[1] = 1.571;
  r[27].velocity_limits[0] = -12;
  r[27].velocity_limits[1] = 12;
  r[27].torque_limits[0] = -114;
  r[27].torque_limits[1] = 114;

  r[28].joint_name = "r_arm_mwx";
  r[28].link_name = "r_hand";
  r[28].index = 28;
  r[28].parent = 27;
  r[28].children[0] = -1;
  r[28].joint_offset_b[XX] = 0;
  r[28].joint_offset_b[YY] = -0.058;
  r[28].joint_offset_b[ZZ] = 0;
  r[28].joint_type = 2;
  r[28].axis_b[XX] = 1;
  r[28].axis_b[YY] = 0;
  r[28].axis_b[ZZ] = 0;
  r[28].mass = 2.263;
  r[28].com_offset_b[XX] = 0;
  r[28].com_offset_b[YY] = -0.093;
  r[28].com_offset_b[ZZ] = 0;
  r[28].moi_diagonal = 1;
  r[28].moi_v[XX] = 0.01;
  r[28].moi_v[YY] = 0.002;
  r[28].moi_v[ZZ] = 0.01;
  r[28].moi[XX][XX] = 0.01;
  r[28].moi[XX][YY] = 0;
  r[28].moi[XX][ZZ] = 0;
  r[28].moi[YY][XX] = 0;
  r[28].moi[YY][YY] = 0.002;
  r[28].moi[YY][ZZ] = 0;
  r[28].moi[ZZ][XX] = 0;
  r[28].moi[ZZ][YY] = 0;
  r[28].moi[ZZ][ZZ] = 0.01;
  r[28].angle_limits[0] = -1.571;
  r[28].angle_limits[1] = 0.436;
  r[28].velocity_limits[0] = -12;
  r[28].velocity_limits[1] = 12;
  r[28].torque_limits[0] = -60;
  r[28].torque_limits[1] = 60;
}


void init_lleg( KIN_DYN *r )
{
  r[0].joint_name = "groundj";
  r[0].link_name = "l_foot";
  r[0].index = 0;
  r[0].parent = -1;
  r[0].children[0] = 1;
  r[0].children[1] = -1;
  r[0].joint_offset_b[XX] = 0;
  r[0].joint_offset_b[YY] = 0.089;
  r[0].joint_offset_b[ZZ] = 0;
  r[0].joint_type = 8;
  r[0].axis_b[XX] = 1;
  r[0].axis_b[YY] = 0;
  r[0].axis_b[ZZ] = 0;
  r[0].mass = 1.634;
  r[0].com_offset_b[XX] = -0.0214;
  r[0].com_offset_b[YY] = 0;
  r[0].com_offset_b[ZZ] = 0.0141;
  r[0].moi_diagonal = 1;
  r[0].moi_v[XX] = 0.002;
  r[0].moi_v[YY] = 0.007;
  r[0].moi_v[ZZ] = 0.008;
  r[0].moi[XX][XX] = 0.002;
  r[0].moi[XX][YY] = 0;
  r[0].moi[XX][ZZ] = 0;
  r[0].moi[YY][XX] = 0;
  r[0].moi[YY][YY] = 0.007;
  r[0].moi[YY][ZZ] = 0;
  r[0].moi[ZZ][XX] = 0;
  r[0].moi[ZZ][YY] = 0;
  r[0].moi[ZZ][ZZ] = 0.008;
  r[0].angle_limits[0] = 0;
  r[0].angle_limits[1] = 0;
  r[0].velocity_limits[0] = 0;
  r[0].velocity_limits[1] = 0;
  r[0].torque_limits[0] = 0;
  r[0].torque_limits[1] = 0;

  r[1].joint_name = "l_leg_lax";
  r[1].link_name = "l_talus";
  r[1].index = 1;
  r[1].parent = 0;
  r[1].children[0] = 2;
  r[1].children[1] = -1;
  r[1].joint_offset_b[XX] = -0.0484;
  r[1].joint_offset_b[YY] = 0;
  r[1].joint_offset_b[ZZ] = 0.0811;
  r[1].joint_type = 5;
  r[1].axis_b[XX] = -1;
  r[1].axis_b[YY] = 0;
  r[1].axis_b[ZZ] = 0;
  r[1].mass = 0.1;
  r[1].com_offset_b[XX] = 0;
  r[1].com_offset_b[YY] = 0;
  r[1].com_offset_b[ZZ] = 0;
  r[1].moi_diagonal = 1;
  r[1].moi_v[XX] = 1.01674e-05;
  r[1].moi_v[YY] = 8.42775e-06;
  r[1].moi_v[ZZ] = 1.30101e-05;
  r[1].moi[XX][XX] = 1.01674e-05;
  r[1].moi[XX][YY] = 0;
  r[1].moi[XX][ZZ] = 0;
  r[1].moi[YY][XX] = 0;
  r[1].moi[YY][YY] = 8.42775e-06;
  r[1].moi[YY][ZZ] = 0;
  r[1].moi[ZZ][XX] = 0;
  r[1].moi[ZZ][YY] = 0;
  r[1].moi[ZZ][ZZ] = 1.30101e-05;
  r[1].angle_limits[0] = -0.436;
  r[1].angle_limits[1] = 0.436;
  r[1].velocity_limits[0] = -12;
  r[1].velocity_limits[1] = 12;
  r[1].torque_limits[0] = -90;
  r[1].torque_limits[1] = 90;

  r[2].joint_name = "l_leg_uay";
  r[2].link_name = "l_lleg";
  r[2].index = 2;
  r[2].parent = 1;
  r[2].children[0] = 3;
  r[2].children[1] = -1;
  r[2].joint_offset_b[XX] = 0;
  r[2].joint_offset_b[YY] = 0;
  r[2].joint_offset_b[ZZ] = 0;
  r[2].joint_type = 6;
  r[2].axis_b[XX] = 0;
  r[2].axis_b[YY] = -1;
  r[2].axis_b[ZZ] = 0;
  r[2].mass = 4.367;
  r[2].com_offset_b[XX] = 0.001;
  r[2].com_offset_b[YY] = 0;
  r[2].com_offset_b[ZZ] = 0.235;
  r[2].moi_diagonal = 0;
  r[2].moi_v[XX] = 0.077;
  r[2].moi_v[YY] = 0.076;
  r[2].moi_v[ZZ] = 0.01;
  r[2].moi[XX][XX] = 0.077;
  r[2].moi[XX][YY] = 0;
  r[2].moi[XX][ZZ] = -0.003;
  r[2].moi[YY][XX] = 0;
  r[2].moi[YY][YY] = 0.076;
  r[2].moi[YY][ZZ] = 0;
  r[2].moi[ZZ][XX] = -0.003;
  r[2].moi[ZZ][YY] = 0;
  r[2].moi[ZZ][ZZ] = 0.01;
  r[2].angle_limits[0] = -0.698;
  r[2].angle_limits[1] = 0.698;
  r[2].velocity_limits[0] = -12;
  r[2].velocity_limits[1] = 12;
  r[2].torque_limits[0] = -220;
  r[2].torque_limits[1] = 220;

  r[3].joint_name = "l_leg_kny";
  r[3].link_name = "l_uleg";
  r[3].index = 3;
  r[3].parent = 2;
  r[3].children[0] = 4;
  r[3].children[1] = -1;
  r[3].joint_offset_b[XX] = 0;
  r[3].joint_offset_b[YY] = 0;
  r[3].joint_offset_b[ZZ] = 0.422;
  r[3].joint_type = 6;
  r[3].axis_b[XX] = 0;
  r[3].axis_b[YY] = -1;
  r[3].axis_b[ZZ] = 0;
  r[3].mass = 7.34;
  r[3].com_offset_b[XX] = 0.05;
  r[3].com_offset_b[YY] = 0;
  r[3].com_offset_b[ZZ] = 0.164;
  r[3].moi_diagonal = 1;
  r[3].moi_v[XX] = 0.09;
  r[3].moi_v[YY] = 0.09;
  r[3].moi_v[ZZ] = 0.02;
  r[3].moi[XX][XX] = 0.09;
  r[3].moi[XX][YY] = 0;
  r[3].moi[XX][ZZ] = 0;
  r[3].moi[YY][XX] = 0;
  r[3].moi[YY][YY] = 0.09;
  r[3].moi[YY][ZZ] = 0;
  r[3].moi[ZZ][XX] = 0;
  r[3].moi[ZZ][YY] = 0;
  r[3].moi[ZZ][ZZ] = 0.02;
  r[3].angle_limits[0] = 0;
  r[3].angle_limits[1] = 2.45;
  r[3].velocity_limits[0] = -12;
  r[3].velocity_limits[1] = 12;
  r[3].torque_limits[0] = -220;
  r[3].torque_limits[1] = 220;

  r[4].joint_name = "l_leg_lhy";
  r[4].link_name = "l_lglut";
  r[4].index = 4;
  r[4].parent = 3;
  r[4].children[0] = 5;
  r[4].children[1] = -1;
  r[4].joint_offset_b[XX] = 0.05;
  r[4].joint_offset_b[YY] = 0;
  r[4].joint_offset_b[ZZ] = 0.374;
  r[4].joint_type = 6;
  r[4].axis_b[XX] = 0;
  r[4].axis_b[YY] = -1;
  r[4].axis_b[ZZ] = 0;
  r[4].mass = 0.69;
  r[4].com_offset_b[XX] = -0.0366659;
  r[4].com_offset_b[YY] = 0.0170484;
  r[4].com_offset_b[ZZ] = 0.0187948;
  r[4].moi_diagonal = 0;
  r[4].moi_v[XX] = 0.000691326;
  r[4].moi_v[YY] = 0.00126856;
  r[4].moi_v[ZZ] = 0.00106487;
  r[4].moi[XX][XX] = 0.000691326;
  r[4].moi[XX][YY] = -2.24344e-05;
  r[4].moi[XX][ZZ] = 2.50508e-06;
  r[4].moi[YY][XX] = -2.24344e-05;
  r[4].moi[YY][YY] = 0.00126856;
  r[4].moi[YY][ZZ] = 0.000137862;
  r[4].moi[ZZ][XX] = 2.50508e-06;
  r[4].moi[ZZ][YY] = 0.000137862;
  r[4].moi[ZZ][ZZ] = 0.00106487;
  r[4].angle_limits[0] = -1.75;
  r[4].angle_limits[1] = 0.524;
  r[4].velocity_limits[0] = -12;
  r[4].velocity_limits[1] = 12;
  r[4].torque_limits[0] = -260;
  r[4].torque_limits[1] = 260;

  r[5].joint_name = "l_leg_mhx";
  r[5].link_name = "l_uglut";
  r[5].index = 5;
  r[5].parent = 4;
  r[5].children[0] = 6;
  r[5].children[1] = -1;
  r[5].joint_offset_b[XX] = -0.05;
  r[5].joint_offset_b[YY] = 0;
  r[5].joint_offset_b[ZZ] = 0.05;
  r[5].joint_type = 5;
  r[5].axis_b[XX] = -1;
  r[5].axis_b[YY] = 0;
  r[5].axis_b[ZZ] = 0;
  r[5].mass = 0.5166;
  r[5].com_offset_b[XX] = 0.00529262;
  r[5].com_offset_b[YY] = -0.00344732;
  r[5].com_offset_b[ZZ] = 0.00313046;
  r[5].moi_diagonal = 0;
  r[5].moi_v[XX] = 0.00074276;
  r[5].moi_v[YY] = 0.000688179;
  r[5].moi_v[ZZ] = 0.00041242;
  r[5].moi[XX][XX] = 0.00074276;
  r[5].moi[XX][YY] = -3.79607e-08;
  r[5].moi[XX][ZZ] = -2.79549e-05;
  r[5].moi[YY][XX] = -3.79607e-08;
  r[5].moi[YY][YY] = 0.000688179;
  r[5].moi[YY][ZZ] = -3.2735e-08;
  r[5].moi[ZZ][XX] = -2.79549e-05;
  r[5].moi[ZZ][YY] = -3.2735e-08;
  r[5].moi[ZZ][ZZ] = 0.00041242;
  r[5].angle_limits[0] = -0.47;
  r[5].angle_limits[1] = 0.495;
  r[5].velocity_limits[0] = -12;
  r[5].velocity_limits[1] = 12;
  r[5].torque_limits[0] = -180;
  r[5].torque_limits[1] = 180;

  r[6].joint_name = "l_leg_uhz";
  r[6].link_name = "pelvis";
  r[6].index = 6;
  r[6].parent = 5;
  r[6].children[0] = -1;
  r[6].joint_offset_b[XX] = 0;
  r[6].joint_offset_b[YY] = 0;
  r[6].joint_offset_b[ZZ] = 0;
  r[6].joint_type = 7;
  r[6].axis_b[XX] = 0;
  r[6].axis_b[YY] = 0;
  r[6].axis_b[ZZ] = -1;
  r[6].mass = 14.2529;
  r[6].com_offset_b[XX] = 0.0111;
  r[6].com_offset_b[YY] = -0.089;
  r[6].com_offset_b[ZZ] = 0.0271;
  r[6].moi_diagonal = 0;
  r[6].moi_v[XX] = 0.1244;
  r[6].moi_v[YY] = 0.0958;
  r[6].moi_v[ZZ] = 0.1167;
  r[6].moi[XX][XX] = 0.1244;
  r[6].moi[XX][YY] = 0.0008;
  r[6].moi[XX][ZZ] = -0.0007;
  r[6].moi[YY][XX] = 0.0008;
  r[6].moi[YY][YY] = 0.0958;
  r[6].moi[YY][ZZ] = -0.0005;
  r[6].moi[ZZ][XX] = -0.0007;
  r[6].moi[ZZ][YY] = -0.0005;
  r[6].moi[ZZ][ZZ] = 0.1167;
  r[6].angle_limits[0] = -0.32;
  r[6].angle_limits[1] = 1.14;
  r[6].velocity_limits[0] = -12;
  r[6].velocity_limits[1] = 12;
  r[6].torque_limits[0] = -110;
  r[6].torque_limits[1] = 110;
}


void init_rleg( KIN_DYN *r )
{
  r[0].joint_name = "groundj";
  r[0].link_name = "r_foot";
  r[0].index = 0;
  r[0].parent = -1;
  r[0].children[0] = 1;
  r[0].children[1] = -1;
  r[0].joint_offset_b[XX] = 0;
  r[0].joint_offset_b[YY] = -0.089;
  r[0].joint_offset_b[ZZ] = 0;
  r[0].joint_type = 8;
  r[0].axis_b[XX] = 1;
  r[0].axis_b[YY] = 0;
  r[0].axis_b[ZZ] = 0;
  r[0].mass = 1.634;
  r[0].com_offset_b[XX] = -0.0214;
  r[0].com_offset_b[YY] = 0;
  r[0].com_offset_b[ZZ] = 0.0141;
  r[0].moi_diagonal = 1;
  r[0].moi_v[XX] = 0.002;
  r[0].moi_v[YY] = 0.007;
  r[0].moi_v[ZZ] = 0.008;
  r[0].moi[XX][XX] = 0.002;
  r[0].moi[XX][YY] = 0;
  r[0].moi[XX][ZZ] = 0;
  r[0].moi[YY][XX] = 0;
  r[0].moi[YY][YY] = 0.007;
  r[0].moi[YY][ZZ] = 0;
  r[0].moi[ZZ][XX] = 0;
  r[0].moi[ZZ][YY] = 0;
  r[0].moi[ZZ][ZZ] = 0.008;
  r[0].angle_limits[0] = 0;
  r[0].angle_limits[1] = 0;
  r[0].velocity_limits[0] = 0;
  r[0].velocity_limits[1] = 0;
  r[0].torque_limits[0] = 0;
  r[0].torque_limits[1] = 0;

  r[1].joint_name = "r_leg_lax";
  r[1].link_name = "r_talus";
  r[1].index = 1;
  r[1].parent = 0;
  r[1].children[0] = 2;
  r[1].children[1] = -1;
  r[1].joint_offset_b[XX] = -0.0484;
  r[1].joint_offset_b[YY] = 0;
  r[1].joint_offset_b[ZZ] = 0.0811;
  r[1].joint_type = 5;
  r[1].axis_b[XX] = -1;
  r[1].axis_b[YY] = 0;
  r[1].axis_b[ZZ] = 0;
  r[1].mass = 0.1;
  r[1].com_offset_b[XX] = 0;
  r[1].com_offset_b[YY] = 0;
  r[1].com_offset_b[ZZ] = 0;
  r[1].moi_diagonal = 1;
  r[1].moi_v[XX] = 1.01674e-05;
  r[1].moi_v[YY] = 8.42775e-06;
  r[1].moi_v[ZZ] = 1.30101e-05;
  r[1].moi[XX][XX] = 1.01674e-05;
  r[1].moi[XX][YY] = 0;
  r[1].moi[XX][ZZ] = 0;
  r[1].moi[YY][XX] = 0;
  r[1].moi[YY][YY] = 8.42775e-06;
  r[1].moi[YY][ZZ] = 0;
  r[1].moi[ZZ][XX] = 0;
  r[1].moi[ZZ][YY] = 0;
  r[1].moi[ZZ][ZZ] = 1.30101e-05;
  r[1].angle_limits[0] = -0.436;
  r[1].angle_limits[1] = 0.436;
  r[1].velocity_limits[0] = -12;
  r[1].velocity_limits[1] = 12;
  r[1].torque_limits[0] = -90;
  r[1].torque_limits[1] = 90;

  r[2].joint_name = "r_leg_uay";
  r[2].link_name = "r_lleg";
  r[2].index = 2;
  r[2].parent = 1;
  r[2].children[0] = 3;
  r[2].children[1] = -1;
  r[2].joint_offset_b[XX] = 0;
  r[2].joint_offset_b[YY] = 0;
  r[2].joint_offset_b[ZZ] = 0;
  r[2].joint_type = 6;
  r[2].axis_b[XX] = 0;
  r[2].axis_b[YY] = -1;
  r[2].axis_b[ZZ] = 0;
  r[2].mass = 4.367;
  r[2].com_offset_b[XX] = 0.001;
  r[2].com_offset_b[YY] = 0;
  r[2].com_offset_b[ZZ] = 0.235;
  r[2].moi_diagonal = 0;
  r[2].moi_v[XX] = 0.077;
  r[2].moi_v[YY] = 0.076;
  r[2].moi_v[ZZ] = 0.01;
  r[2].moi[XX][XX] = 0.077;
  r[2].moi[XX][YY] = -0;
  r[2].moi[XX][ZZ] = -0.003;
  r[2].moi[YY][XX] = -0;
  r[2].moi[YY][YY] = 0.076;
  r[2].moi[YY][ZZ] = -0;
  r[2].moi[ZZ][XX] = -0.003;
  r[2].moi[ZZ][YY] = -0;
  r[2].moi[ZZ][ZZ] = 0.01;
  r[2].angle_limits[0] = -0.698;
  r[2].angle_limits[1] = 0.698;
  r[2].velocity_limits[0] = -12;
  r[2].velocity_limits[1] = 12;
  r[2].torque_limits[0] = -220;
  r[2].torque_limits[1] = 220;

  r[3].joint_name = "r_leg_kny";
  r[3].link_name = "r_uleg";
  r[3].index = 3;
  r[3].parent = 2;
  r[3].children[0] = 4;
  r[3].children[1] = -1;
  r[3].joint_offset_b[XX] = 0;
  r[3].joint_offset_b[YY] = 0;
  r[3].joint_offset_b[ZZ] = 0.422;
  r[3].joint_type = 6;
  r[3].axis_b[XX] = 0;
  r[3].axis_b[YY] = -1;
  r[3].axis_b[ZZ] = 0;
  r[3].mass = 7.34;
  r[3].com_offset_b[XX] = 0.05;
  r[3].com_offset_b[YY] = 0;
  r[3].com_offset_b[ZZ] = 0.164;
  r[3].moi_diagonal = 1;
  r[3].moi_v[XX] = 0.09;
  r[3].moi_v[YY] = 0.09;
  r[3].moi_v[ZZ] = 0.02;
  r[3].moi[XX][XX] = 0.09;
  r[3].moi[XX][YY] = 0;
  r[3].moi[XX][ZZ] = 0;
  r[3].moi[YY][XX] = 0;
  r[3].moi[YY][YY] = 0.09;
  r[3].moi[YY][ZZ] = 0;
  r[3].moi[ZZ][XX] = 0;
  r[3].moi[ZZ][YY] = 0;
  r[3].moi[ZZ][ZZ] = 0.02;
  r[3].angle_limits[0] = 0;
  r[3].angle_limits[1] = 2.45;
  r[3].velocity_limits[0] = -12;
  r[3].velocity_limits[1] = 12;
  r[3].torque_limits[0] = -220;
  r[3].torque_limits[1] = 220;

  r[4].joint_name = "r_leg_lhy";
  r[4].link_name = "r_lglut";
  r[4].index = 4;
  r[4].parent = 3;
  r[4].children[0] = 5;
  r[4].children[1] = -1;
  r[4].joint_offset_b[XX] = 0.05;
  r[4].joint_offset_b[YY] = 0;
  r[4].joint_offset_b[ZZ] = 0.374;
  r[4].joint_type = 6;
  r[4].axis_b[XX] = 0;
  r[4].axis_b[YY] = -1;
  r[4].axis_b[ZZ] = 0;
  r[4].mass = 0.69;
  r[4].com_offset_b[XX] = -0.0366659;
  r[4].com_offset_b[YY] = -0.0170484;
  r[4].com_offset_b[ZZ] = 0.0187948;
  r[4].moi_diagonal = 0;
  r[4].moi_v[XX] = 0.000691326;
  r[4].moi_v[YY] = 0.00126856;
  r[4].moi_v[ZZ] = 0.00106487;
  r[4].moi[XX][XX] = 0.000691326;
  r[4].moi[XX][YY] = 2.24344e-05;
  r[4].moi[XX][ZZ] = 2.50508e-06;
  r[4].moi[YY][XX] = 2.24344e-05;
  r[4].moi[YY][YY] = 0.00126856;
  r[4].moi[YY][ZZ] = -0.000137862;
  r[4].moi[ZZ][XX] = 2.50508e-06;
  r[4].moi[ZZ][YY] = -0.000137862;
  r[4].moi[ZZ][ZZ] = 0.00106487;
  r[4].angle_limits[0] = -1.745;
  r[4].angle_limits[1] = 0.524;
  r[4].velocity_limits[0] = -12;
  r[4].velocity_limits[1] = 12;
  r[4].torque_limits[0] = -260;
  r[4].torque_limits[1] = 260;

  r[5].joint_name = "r_leg_mhx";
  r[5].link_name = "r_uglut";
  r[5].index = 5;
  r[5].parent = 4;
  r[5].children[0] = 6;
  r[5].children[1] = -1;
  r[5].joint_offset_b[XX] = -0.05;
  r[5].joint_offset_b[YY] = 0;
  r[5].joint_offset_b[ZZ] = 0.05;
  r[5].joint_type = 5;
  r[5].axis_b[XX] = -1;
  r[5].axis_b[YY] = 0;
  r[5].axis_b[ZZ] = 0;
  r[5].mass = 0.5166;
  r[5].com_offset_b[XX] = 0.00529262;
  r[5].com_offset_b[YY] = 0.00344732;
  r[5].com_offset_b[ZZ] = 0.00313046;
  r[5].moi_diagonal = 0;
  r[5].moi_v[XX] = 0.00074276;
  r[5].moi_v[YY] = 0.000688179;
  r[5].moi_v[ZZ] = 0.00041242;
  r[5].moi[XX][XX] = 0.00074276;
  r[5].moi[XX][YY] = 3.79607e-08;
  r[5].moi[XX][ZZ] = -2.79549e-05;
  r[5].moi[YY][XX] = 3.79607e-08;
  r[5].moi[YY][YY] = 0.000688179;
  r[5].moi[YY][ZZ] = 3.2735e-08;
  r[5].moi[ZZ][XX] = -2.79549e-05;
  r[5].moi[ZZ][YY] = 3.2735e-08;
  r[5].moi[ZZ][ZZ] = 0.00041242;
  r[5].angle_limits[0] = -0.495;
  r[5].angle_limits[1] = 0.47;
  r[5].velocity_limits[0] = -12;
  r[5].velocity_limits[1] = 12;
  r[5].torque_limits[0] = -180;
  r[5].torque_limits[1] = 180;

  r[6].joint_name = "r_leg_uhz";
  r[6].link_name = "pelvis";
  r[6].index = 6;
  r[6].parent = 5;
  r[6].children[0] = -1;
  r[6].joint_offset_b[XX] = 0;
  r[6].joint_offset_b[YY] = 0;
  r[6].joint_offset_b[ZZ] = 0;
  r[6].joint_type = 7;
  r[6].axis_b[XX] = 0;
  r[6].axis_b[YY] = 0;
  r[6].axis_b[ZZ] = -1;
  r[6].mass = 14.2529;
  r[6].com_offset_b[XX] = 0.0111;
  r[6].com_offset_b[YY] = 0.089;
  r[6].com_offset_b[ZZ] = 0.0271;
  r[6].moi_diagonal = 0;
  r[6].moi_v[XX] = 0.1244;
  r[6].moi_v[YY] = 0.0958;
  r[6].moi_v[ZZ] = 0.1167;
  r[6].moi[XX][XX] = 0.1244;
  r[6].moi[XX][YY] = 0.0008;
  r[6].moi[XX][ZZ] = -0.0007;
  r[6].moi[YY][XX] = 0.0008;
  r[6].moi[YY][YY] = 0.0958;
  r[6].moi[YY][ZZ] = -0.0005;
  r[6].moi[ZZ][XX] = -0.0007;
  r[6].moi[ZZ][YY] = -0.0005;
  r[6].moi[ZZ][ZZ] = 0.1167;
  r[6].angle_limits[0] = -1.14;
  r[6].angle_limits[1] = 0.32;
  r[6].velocity_limits[0] = -12;
  r[6].velocity_limits[1] = 12;
  r[6].torque_limits[0] = -260;
  r[6].torque_limits[1] = 260;
}


/************************************************************************/

void inverse_dynamics( KIN_DYN *r )
{

  // assumes sine, cosine, angled, and angledd for all joints already set.
  // joint/link 0 angular_velocity, angular_acceleration, 
  // and joint_acceleration are all zero.

  id_pass1_z( r, AIR_JOINT_BACK_LBZ );
  id_pass1_y( r, AIR_JOINT_BACK_MBY );
  id_pass1_x( r, AIR_JOINT_BACK_UBX );
  id_pass1_y( r, AIR_JOINT_NECK_AY );

  id_pass1_z( r, AIR_JOINT_L_LEG_UHZ );
  id_pass1_x( r, AIR_JOINT_L_LEG_MHX );
  id_pass1_y( r, AIR_JOINT_L_LEG_LHY );
  id_pass1_y( r, AIR_JOINT_L_LEG_KNY );
  id_pass1_y( r, AIR_JOINT_L_LEG_UAY );
  id_pass1_x( r, AIR_JOINT_L_LEG_LAX );

  id_pass1_z( r, AIR_JOINT_R_LEG_UHZ );
  id_pass1_x( r, AIR_JOINT_R_LEG_MHX );
  id_pass1_y( r, AIR_JOINT_R_LEG_LHY );
  id_pass1_y( r, AIR_JOINT_R_LEG_KNY );
  id_pass1_y( r, AIR_JOINT_R_LEG_UAY );
  id_pass1_x( r, AIR_JOINT_R_LEG_LAX );

  id_pass1_r( r, AIR_JOINT_L_ARM_USY );
  id_pass1_x( r, AIR_JOINT_L_ARM_SHX );
  id_pass1_y( r, AIR_JOINT_L_ARM_ELY );
  id_pass1_x( r, AIR_JOINT_L_ARM_ELX );
  id_pass1_y( r, AIR_JOINT_L_ARM_UWY );
  id_pass1_x( r, AIR_JOINT_L_ARM_MWX );

  id_pass1_r( r, AIR_JOINT_R_ARM_USY );
  id_pass1_x( r, AIR_JOINT_R_ARM_SHX );
  id_pass1_y( r, AIR_JOINT_R_ARM_ELY );
  id_pass1_x( r, AIR_JOINT_R_ARM_ELX );
  id_pass1_y( r, AIR_JOINT_R_ARM_UWY );
  id_pass1_x( r, AIR_JOINT_R_ARM_MWX );

  //printf( "PASS 2\n" );

  id_pass2( r, AIR_JOINT_R_ARM_MWX );
  id_pass2( r, AIR_JOINT_R_ARM_UWY );
  id_pass2( r, AIR_JOINT_R_ARM_ELX );
  id_pass2( r, AIR_JOINT_R_ARM_ELY );
  id_pass2( r, AIR_JOINT_R_ARM_SHX );
  id_pass2( r, AIR_JOINT_R_ARM_USY );

  id_pass2( r, AIR_JOINT_L_ARM_MWX );
  id_pass2( r, AIR_JOINT_L_ARM_UWY );
  id_pass2( r, AIR_JOINT_L_ARM_ELX );
  id_pass2( r, AIR_JOINT_L_ARM_ELY );
  id_pass2( r, AIR_JOINT_L_ARM_SHX );
  id_pass2( r, AIR_JOINT_L_ARM_USY );

  id_pass2( r, AIR_JOINT_R_LEG_LAX );
  id_pass2( r, AIR_JOINT_R_LEG_UAY );
  id_pass2( r, AIR_JOINT_R_LEG_KNY );
  id_pass2( r, AIR_JOINT_R_LEG_LHY );
  id_pass2( r, AIR_JOINT_R_LEG_MHX );
  id_pass2( r, AIR_JOINT_R_LEG_UHZ );

  id_pass2( r, AIR_JOINT_L_LEG_LAX );
  id_pass2( r, AIR_JOINT_L_LEG_UAY );
  id_pass2( r, AIR_JOINT_L_LEG_KNY );
  id_pass2( r, AIR_JOINT_L_LEG_LHY );
  id_pass2( r, AIR_JOINT_L_LEG_MHX );
  id_pass2( r, AIR_JOINT_L_LEG_UHZ );

  id_pass2( r, AIR_JOINT_NECK_AY );
  id_pass2( r, AIR_JOINT_BACK_UBX );
  id_pass2( r, AIR_JOINT_BACK_MBY );
  id_pass2( r, AIR_JOINT_BACK_LBZ );

  id_pass2( r, AIR_JOINT_ROOT );
}

void lleg_id( KIN_DYN *r, double pelv_force[3], double pelv_torque[3])
{

  // assumes sine, cosine, angled, and angledd for all joints already set.
  // joint/link 0 angular_velocity, angular_acceleration, 
  // and joint_acceleration are all zero.

  id_pass1_mx( r, LLEG_JOINT_L_LEG_LAX );
  id_pass1_my( r, LLEG_JOINT_L_LEG_UAY );
  id_pass1_my( r, LLEG_JOINT_L_LEG_KNY );
  id_pass1_my( r, LLEG_JOINT_L_LEG_LHY );
  id_pass1_mx( r, LLEG_JOINT_L_LEG_MHX );
  id_pass1_mz( r, LLEG_JOINT_L_LEG_UHZ );

  // set forces and torques on pelvis
	v3_copy(pelv_force, r[LLEG_JOINT_L_LEG_UHZ].link_force_w);
	v3_copy(pelv_torque, r[LLEG_JOINT_L_LEG_UHZ].link_torque_w);
	mtv3_multiply(r[LLEG_JOINT_L_LEG_UHZ].orientation, r[LLEG_JOINT_L_LEG_UHZ].link_force_w, r[LLEG_JOINT_L_LEG_UHZ].link_force_b);
	mtv3_multiply(r[LLEG_JOINT_L_LEG_UHZ].orientation, r[LLEG_JOINT_L_LEG_UHZ].link_torque_w, r[LLEG_JOINT_L_LEG_UHZ].link_torque_b);

	v3_copy(pelv_force, r[LLEG_JOINT_L_LEG_UHZ].joint_force_w);
	v3_copy(pelv_torque, r[LLEG_JOINT_L_LEG_UHZ].joint_torque_w);
	mtv3_multiply(r[LLEG_JOINT_L_LEG_UHZ].orientation, r[LLEG_JOINT_L_LEG_UHZ].joint_force_w, r[LLEG_JOINT_L_LEG_UHZ].joint_force_b);
	mtv3_multiply(r[LLEG_JOINT_L_LEG_UHZ].orientation, r[LLEG_JOINT_L_LEG_UHZ].joint_torque_w, r[LLEG_JOINT_L_LEG_UHZ].joint_torque_b);

  //printf( "PASS 2\n" );
  id_pass2_no_sum( r, LLEG_JOINT_L_LEG_UHZ );
  id_pass2( r, LLEG_JOINT_L_LEG_MHX );
  id_pass2( r, LLEG_JOINT_L_LEG_LHY );
  id_pass2( r, LLEG_JOINT_L_LEG_KNY );
  id_pass2( r, LLEG_JOINT_L_LEG_UAY );
  id_pass2( r, LLEG_JOINT_L_LEG_LAX );
  /*
  id_pass2_fixed( r, LLEG_JOINT_L_GROUND );
  */
}

void rleg_id( KIN_DYN *r, double pelv_force[3], double pelv_torque[3] )
{

  // assumes sine, cosine, angled, and angledd for all joints already set.
  // joint/link 0 angular_velocity, angular_acceleration, 
  // and joint_acceleration are all zero.

  id_pass1_mx( r, RLEG_JOINT_R_LEG_LAX );
  id_pass1_my( r, RLEG_JOINT_R_LEG_UAY );
  id_pass1_my( r, RLEG_JOINT_R_LEG_KNY );
  id_pass1_my( r, RLEG_JOINT_R_LEG_LHY );
  id_pass1_mx( r, RLEG_JOINT_R_LEG_MHX );
  id_pass1_mz( r, RLEG_JOINT_R_LEG_UHZ );


  // set forces and torques on pelvis
	v3_copy(pelv_force, r[RLEG_JOINT_R_LEG_UHZ].link_force_w);
	v3_copy(pelv_torque, r[RLEG_JOINT_R_LEG_UHZ].link_torque_w);
	mtv3_multiply(r[RLEG_JOINT_R_LEG_UHZ].orientation, r[RLEG_JOINT_R_LEG_UHZ].link_force_w, r[RLEG_JOINT_R_LEG_UHZ].link_force_b);
	mtv3_multiply(r[RLEG_JOINT_R_LEG_UHZ].orientation, r[RLEG_JOINT_R_LEG_UHZ].link_torque_w, r[RLEG_JOINT_R_LEG_UHZ].link_torque_b);

	v3_copy(pelv_force, r[RLEG_JOINT_R_LEG_UHZ].joint_force_w);
	v3_copy(pelv_torque, r[RLEG_JOINT_R_LEG_UHZ].joint_torque_w);
	mtv3_multiply(r[RLEG_JOINT_R_LEG_UHZ].orientation, r[RLEG_JOINT_R_LEG_UHZ].joint_force_w, r[RLEG_JOINT_R_LEG_UHZ].joint_force_b);
	mtv3_multiply(r[RLEG_JOINT_R_LEG_UHZ].orientation, r[RLEG_JOINT_R_LEG_UHZ].joint_torque_w, r[RLEG_JOINT_R_LEG_UHZ].joint_torque_b);


  //printf( "PASS 2\n" );

  id_pass2_no_sum( r, RLEG_JOINT_R_LEG_UHZ );
  id_pass2( r, RLEG_JOINT_R_LEG_MHX );
  id_pass2( r, RLEG_JOINT_R_LEG_LHY );
  id_pass2( r, RLEG_JOINT_R_LEG_KNY );
  id_pass2( r, RLEG_JOINT_R_LEG_UAY );
  id_pass2( r, RLEG_JOINT_R_LEG_LAX );
  /*
  id_pass2_fixed( r, RLEG_JOINT_R_GROUND );
  */
}

void mexFunction( int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[] );
